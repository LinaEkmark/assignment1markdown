<p><strong><em>normal _ strong em</em></strong></p>
<p><strong><em>normal_____strong____em</em></strong></p>
<p><strong>smart______strong</strong></p>
<p><em>smart____em</em></p>
<p>Breaks normal strong em. <strong><em>strong em</em> just strong with trailing underscore_</strong></p>
<p><strong><em>eat trailing tokens____</em></strong></p>
<p>____smart boundary to left wont let this trigger___</p>
<p><strong><em>normal_strong__and_em</em></strong></p>
<p><strong><em>strong em</em> just strong</strong></p>
<p><em><strong>em strong</strong> just em</em></p>
<p>___ not valid ___</p>
<p>__ not valid __</p>
<p>_ not valid _</p>
<p>___not valid__ not valid _</p>
<p>___not valid_ not valid _</p>
<p>___ not valid __em_</p>
<p>___ not valid <em>em_</em></p>
<p><strong>strong</strong> text_</p>
<p><em>em</em> text_</p>
<p>text___not valid___ text</p>
<p>text ___not valid___text</p>
<p>text <strong><em>valid</em></strong> text</p>
<p>text__not valid__ text</p>
<p>text __not valid__text</p>
<p>text <strong>valid</strong> text</p>
<p>text_not valid_ text</p>
<p>text _not valid_text</p>
<p>text <em>valid</em> text</p>